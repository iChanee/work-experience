<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>회사명 | CTI Media</title>
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/sub-page.css">
</head>
<body>
    <header>
        <div class="container">
            <div class="logo">
                <a href="index.html"><img src="images/company_logo.jpg" alt="회사 로고"></a>
            </div>
            <nav>
                <ul>
                    <li class="dropdown">
                        <a href="company-intro.html">회사 소개</a>
                        <div class="dropdown-content">
                            <a href="company-intro.html#greeting">인사말</a>
                            <a href="company-intro.html#business-areas">사업 분야</a>
                            <a href="company-intro.html#partners">협력사</a>
                            <a href="company-intro.html#welfare">복리후생</a>
                        </div>
                    </li>
                    <li class="dropdown">
                        <a href="cti-media.html">CTI Media</a>
                        <div class="dropdown-content">
                            <a href="#company-landscape">회사 풍경</a>
                            <a href="#employee-talk">현직자 소통</a>
                            <a href="#web-magazine-full">웹 매거진</a>
                        </div>
                    </li>
                    <li class="dropdown">
                        <a href="board.html">게시판</a>
                        <div class="dropdown-content">
                            <a href="board.html#community">커뮤니티</a>
                            <a href="board.html#inquiry-full">문의</a>
                        </div>
                    </li>
                    <li class="dropdown">
                        <a href="careers.html">인재/채용</a>
                        <div class="dropdown-content">
                            <a href="careers.html#ideal-talent">인재상</a>
                            <a href="careers.html#job-categories">직무 구분</a>
                            <a href="careers.html#successful-cases">우수 합격 사례</a>
                        </div>
                    </li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <section id="company-landscape" class="main-page-section">
            <div class="container">
                <h2>회사 풍경</h2>
                <p>저희 회사의 활기찬 업무 환경과 편의 시설을 소개합니다.</p>
                <img src="images/office_view1.jpg" alt="회사 내부 사진1" class="img-responsive">
                <img src="images/office_view2.jpg" alt="회사 내부 사진2" class="img-responsive">
            </div>
        </section>

        <section id="employee-talk" class="main-page-section">
            <div class="container">
                <h2>현직자 소통</h2>
                <p>실제 직원들의 생생한 인터뷰와 경험담을 들어보세요.</p>
                <div class="testimonial">
                    <p>"[회사명]에서 일하는 것은 저에게 끊임없는 도전과 성장의 기회를 줍니다." - 개발팀 김철수 대리</p>
                </div>
            </div>
        </section>

        <section id="web-magazine-full" class="main-page-section">
  <div class="container webmagazine-container">
    <div class="webmagazine-header">
      <h2>웹 매거진</h2>
      <div style="flex:1"></div>
      <button id="webzineWriteBtn" class="webzine-write-btn" style="display:none;">글쓰기</button>
    </div>
    <p style="margin-bottom: 24px; color:#555;">
      회사의 최신 소식, 업계 트렌드, 흥미로운 스토리를 웹 매거진에서 만나보세요.
    </p>
    <table class="webzine-table">
      <thead>
        <tr>
          <th style="width:70px;">번호</th>
          <th>제목</th>
          <th style="width:100px;"></th>
        </tr>
      </thead>
      <tbody id="webzineList"></tbody>
    </table>
    <div id="webzine-empty" style="display:none; text-align:center; color:#888; padding:50px 0;">등록된 매거진이 없습니다.</div>
  </div>
</section>

    </main>

    <footer>
		<section id="footer">
        <!--
			<div class="copy_bar">
				<div>
					<p class="copy_menu"><a href="https://www.cti-korea.com/bbs/content.php?co_id=privacy" >개인정보처리방침</a>  &nbsp;&nbsp;&nbsp; <a href="https://www.cti-korea.com/bbs/content.php?co_id=provision" >이용약관</a> &nbsp;&nbsp;&nbsp; <a href="https://www.cti-korea.com/bbs/board.php?bo_table=notice" alt="공지사항" title="공지사항">공지사항</a></p>
				</div>
			</div>
            //-->
			<div class="copy_area">
				<div class="copyright">
					<p>
						<span>씨티아이코리아 주식회사</span>
						<span>대표 : 채현병</span>
						<span>주소 : 충남 천안시 서북구 백석공단1로 10 천안미래에이스하이테크시티 M동 327호</span>
						<span>사업자등록번호 : 312-86-05805</span><br class="pc_br">
						<span>TEL : 041-557-5200</span>
						<span>FAX : 041-557-5204</span>
						<span>개인정보책임관리자 : 채현병</span>
						<span>이메일 : cti@cti-korea.com</span><br class="pc_br">
						<span>Copyright 2020 CTI Korea Co.,Ltd. All Rights Reserved.</span>
					</p>
				</div>
			</div>


		</section>
	</footer>

    <script src="js/script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
  // 관리자 여부 확인
  let isAdmin = false;
  try {
    const meRes = await fetch('/api/me', { credentials: 'include' });
    const me = await meRes.json();
    isAdmin = me.role === 'admin';
  } catch {}
  // 글쓰기 버튼
  const writeBtn = document.getElementById('webzineWriteBtn');
  if (isAdmin) writeBtn.style.display = '';
  else writeBtn.style.display = 'none';
  writeBtn.onclick = () => location.href = 'write-webmagazine.html';

  // 글 목록 불러오기
  const res = await fetch('/api/webmagazine');
  const posts = await res.json();
  const tbody = document.getElementById('webzineList');
  const emptyDiv = document.getElementById('webzine-empty');
  if (!posts.length) {
    emptyDiv.style.display = '';
    return;
  } else {
    emptyDiv.style.display = 'none';
  }
  posts.forEach((p, idx) => {
    const tr = document.createElement('tr');
    let manageTd = '';
    // 관리자면 삭제 버튼 노출
    if (isAdmin) {
      manageTd = `<td>
        <button class="webzine-manage-btn" onclick="deleteWebzine(${p.post_id})">삭제</button>
      </td>`;
    } else {
      manageTd = `<td></td>`;
    }
    tr.innerHTML = `<td style="text-align:center;">${posts.length - idx}</td>
      <td><a href="webmagazine-detail.html?id=${p.post_id}" class="webzine-title-link">${p.title}</a></td>
      ${manageTd}`;
    tbody.appendChild(tr);
  });

  // 삭제 함수(관리자만)
  window.deleteWebzine = async function(postId) {
    if (!confirm('정말 삭제하시겠습니까?')) return;
    const res = await fetch(`/api/webmagazine/${postId}`, {
      method: 'DELETE',
      credentials: 'include'
    });
    if (res.ok) location.reload();
    else alert('삭제 실패 (권한 또는 서버 오류)');
  };
});

    </script>
</body>
</html>